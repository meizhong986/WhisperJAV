<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhisperJAV - Simple Runner</title>
    <!-- Theme stylesheet (swappable at runtime) -->
    <link id="themeStylesheet" rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Main Application Container -->
    <div class="app-container">

        <!-- Header -->
        <header class="app-header">
            <h1>WhisperJAV</h1>
            <div class="header-actions">
                <!-- Minimal theme switch button -->
                <button id="themeBtn" class="theme-button" aria-label="Theme" title="Theme">
                    üé®
                </button>
                <!-- Tiny popover menu -->
                <div id="themeMenu" class="theme-menu" role="menu" aria-label="Select theme">
                    <button class="theme-option" data-theme="default" role="menuitem">Default Theme</button>
                    <button class="theme-option" data-theme="google" role="menuitem">Google Theme</button>
                    <button class="theme-option" data-theme="carbon" role="menuitem">IBM Carbon Theme</button>
                    <button class="theme-option" data-theme="primer" role="menuitem">GitHub Primer Theme</button>
                    <div class="theme-menu-divider"></div>
                    <button class="theme-option update-check-option" id="checkUpdatesBtn" role="menuitem">
                        <span class="update-check-icon">&#x2B06;</span> Check for Updates
                    </button>
                </div>
            </div>
        </header>

        <!-- Update Notification Banner -->
        <div id="updateBanner" class="update-banner">
            <div class="update-banner-content">
                <span class="update-banner-icon">&#x2B06;</span>
                <div class="update-banner-text">
                    <span class="update-banner-title" id="updateTitle">Update Available</span>
                    <span class="update-banner-version" id="updateVersion">v1.7.5 is now available</span>
                </div>
            </div>
            <div class="update-banner-actions">
                <button class="update-btn update-btn-secondary" id="updateReleaseNotesBtn" title="View release notes">
                    Release Notes
                </button>
                <button class="update-btn update-btn-primary" id="updateNowBtn">
                    Update Now
                </button>
                <button class="update-dismiss" id="updateDismissBtn" title="Dismiss" aria-label="Dismiss">
                    &times;
                </button>
            </div>
        </div>

        <!-- Update Progress Overlay -->
        <div id="updateProgressOverlay" class="update-progress-overlay">
            <div class="update-progress-dialog">
                <div class="update-progress-icon">&#x21BB;</div>
                <div class="update-progress-title">Updating WhisperJAV</div>
                <div class="update-progress-message">
                    The application will restart automatically after the update completes.
                </div>
                <div class="update-progress-step" id="updateProgressStep">
                    Preparing update...
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <main class="app-main">

            <!-- Source Section -->
            <section class="section source-section">
                <div class="section-header">
                    <h2>Source</h2>
                </div>
                <div class="section-content">
                    <!-- File List Display -->
                    <div class="file-list-container" id="fileListContainer">
                        <div class="file-list" id="fileList" tabindex="0">
                            <div class="empty-state" id="emptyState">
                                <span class="empty-icon">üìÇ</span>
                                <p>No files selected</p>
                                <p class="empty-hint">Click "Add File(s)" or "Add Folder" to get started</p>
                            </div>
                        </div>
                    </div>

                    <!-- File Management Buttons -->
                    <div class="button-group">
                        <button type="button" class="btn btn-primary" id="addFilesBtn">
                            Add File(s)
                        </button>
                        <button type="button" class="btn btn-primary" id="addFolderBtn">
                            Add Folder
                        </button>
                        <button type="button" class="btn btn-secondary" id="removeSelectedBtn" disabled>
                            Remove Selected
                        </button>
                        <button type="button" class="btn btn-secondary" id="clearBtn" disabled>
                            Clear
                        </button>
                    </div>
                </div>
            </section>

            <!-- Destination Section -->
            <section class="section destination-section">
                <div class="section-header">
                    <h2>Destination</h2>
                </div>
                <div class="section-content">
                    <div class="output-source-toggle">
                        <input type="checkbox" id="outputToSource" checked>
                        <label for="outputToSource">Save next to source video</label>
                    </div>
                    <div class="output-control">
                        <label for="outputDir" class="control-label">Output:</label>
                        <input
                            type="text"
                            id="outputDir"
                            class="output-path"
                            readonly
                            placeholder="Output directory..."
                        >
                        <button type="button" class="btn btn-secondary" id="browseOutputBtn">
                            Browse
                        </button>
                        <button type="button" class="btn btn-secondary" id="openOutputBtn">
                            Open
                        </button>
                    </div>
                </div>
            </section>

            <!-- Tabbed Options Section -->
            <section class="section tabs-section">
                <div class="tabs-container">
                    <!-- Tab Navigation -->
                    <div class="tab-bar" role="tablist">
                        <button
                            class="tab-button active"
                            role="tab"
                            aria-selected="true"
                            aria-controls="tab1-panel"
                            id="tab1-button"
                            data-tab="tab1"
                        >
                            Transcription Mode
                        </button>
                        <button
                            class="tab-button"
                            role="tab"
                            aria-selected="false"
                            aria-controls="tab2-panel"
                            id="tab2-button"
                            data-tab="tab2"
                        >
                            Transcription Adv. Options
                        </button>
                        <button
                            class="tab-button"
                            role="tab"
                            aria-selected="false"
                            aria-controls="tab3-panel"
                            id="tab3-button"
                            data-tab="tab3"
                        >
                            Ensemble Mode
                        </button>
                        <button
                            class="tab-button"
                            role="tab"
                            aria-selected="false"
                            aria-controls="tab4-panel"
                            id="tab4-button"
                            data-tab="tab4"
                        >
                            AI SRT Translate
                        </button>
                    </div>

                    <!-- Tab Content -->
                    <div class="tab-content-container">

                        <!-- Tab 1: Transcription Mode -->
                        <div
                            class="tab-panel active"
                            id="tab1-panel"
                            role="tabpanel"
                            aria-labelledby="tab1-button"
                        >
                            <!-- Row 1: Mode + Sensitivity (left), Source language + Subtitle output (right) -->
                            <div class="form-row form-row-two-column">
                                <!-- Left Column: Mode + Sensitivity -->
                                <div class="form-column">
                                    <!-- Mode Selection -->
                                    <div class="form-group">
                                        <label for="mode" class="form-label">Mode (ASR Engine options):</label>
                                        <select id="mode" class="form-select mode-select">
                                            <option value="fidelity">fidelity&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(large-v2-fp16&nbsp;&nbsp;&nbsp;10GB VRAM)</option>
                                            <option value="balanced" selected>balanced&nbsp;&nbsp;&nbsp;&nbsp;(large-v2-int8&nbsp;&nbsp;&nbsp;&nbsp;6GB VRAM)</option>
                                            <option value="fast">fast&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(turbo-int8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4GB VRAM)</option>
                                            <option value="faster">faster&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(turbo-int8-batch8&nbsp;&nbsp;6GB VRAM)</option>
                                            <!-- kotoba-faster-whisper temporarily hidden (implementation preserved)
                                            <option value="kotoba-faster-whisper">kotoba&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(kotoba-v2-fp16&nbsp;&nbsp;&nbsp;6GB VRAM)</option>
                                            -->
                                            <option value="transformers">transformers&nbsp;&nbsp;(HF kotoba-bilingual&nbsp;6GB VRAM)</option>
                                            <option value="anime" disabled>anime (future placeholder)</option>
                                        </select>
                                    </div>

                                    <!-- Sensitivity -->
                                    <div class="form-group">
                                        <label for="sensitivity" class="form-label">Sensitivity (accuracy vs false-positives):</label>
                                        <select id="sensitivity" class="form-select">
                                            <option value="aggressive" selected>aggressive (hi-details, noise)</option>
                                            <option value="balanced">balanced (details, lo-noise)</option>
                                            <option value="conservative">conservative (lo-details, accurate)</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Right Column: Source Audio Language + Subtitle Output -->
                                <div class="form-column">
                                    <!-- Source Audio Language -->
                                    <div class="form-group">
                                        <label for="source-language" class="form-label">Source audio language:</label>
                                        <select id="source-language" class="form-select">
                                            <option value="japanese" selected>Japanese (Êó•Êú¨Ë™û)</option>
                                            <option value="korean">Korean (ÌïúÍµ≠Ïñ¥)</option>
                                            <option value="chinese">Chinese (‰∏≠Êñá)</option>
                                            <option value="english">English</option>
                                        </select>
                                    </div>

                                    <!-- Subtitle Output Format -->
                                    <div class="form-group">
                                        <label for="language" class="form-label">Subtitle output:</label>
                                        <select id="language" class="form-select">
                                            <option value="native" selected>Native (transcribe in source language)</option>
                                            <option value="direct-to-english">Direct to English (translate via Whisper)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Row 2: Info Labels -->
                            <div class="form-row info-row">
                                <div class="info-group">
                                    <p class="info-text">
                                        Speed vs. Accuracy: 'fast' and 'faster' prioritize throughput; <br>'fidelity' favors accuracy.
                                    </p>
                                </div>
                                <div class="info-group">
                                    <p class="info-text">
                                        Details vs. Noise: 'conservative' reduces false positives; <br>'aggressive' may include noise while capturing more detail.
                                    </p>
                                </div>
                            </div>

                            <!-- Row 3: Transformers Info (shown when transformers mode selected) -->
                            <div class="form-row info-row transformers-info" id="transformersInfoRow" style="display: none;">
                                <div class="info-group full-width">
                                    <p class="info-text info-transformers">
                                        <strong>Transformers Mode:</strong> Uses HuggingFace pipeline with chunked long-form algorithm.
                                        Sensitivity presets do not apply. Use Ensemble tab's "Customize Parameters" button for fine-tuning.
                                    </p>
                                </div>
                            </div>

                        </div>

                        <!-- Tab 2: Advanced Options -->
                        <div
                            class="tab-panel"
                            id="tab2-panel"
                            role="tabpanel"
                            aria-labelledby="tab2-button"
                        >
                            <!-- Row 1: Model override + model select + Async + Debug -->
                            <div class="form-row" id="adv-row-1">
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="modelOverrideEnabled">
                                        <span>Model override</span>
                                    </label>
                                </div>
                                <div class="form-group tight-pair">
                                    <select id="modelSelection" class="form-select" disabled>
                                        <option value="large-v3" selected>large-v3</option>
                                        <option value="large-v2">large-v2</option>
                                        <option value="turbo">turbo</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="asyncProcessing">
                                        <span>Async processing</span>
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="debugLogging">
                                        <span>Debug logging</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Row 2: Keep temp files + Temp directory -->
                            <div class="form-row" id="adv-row-2">
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="keepTemp">
                                        <span>Keep temp files</span>
                                    </label>
                                </div>
                                <div class="form-group temp-dir-group inline-field">
                                    <label for="tempDir" class="form-label" style="white-space: nowrap;">Temp dir:</label>
                                    <div class="input-with-button">
                                        <input
                                            type="text"
                                            id="tempDir"
                                            class="form-input"
                                            placeholder="Default system temp directory"
                                        >
                                        <button type="button" class="btn btn-secondary btn-sm" id="browseTempBtn">
                                            Browse
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Row 3: Accept CPU mode -->
                            <div class="form-row" id="adv-row-3">
                                <div class="form-group">
                                    <label class="checkbox-label" title="Skip GPU performance warning and accept CPU-only mode">
                                        <input type="checkbox" id="acceptCpuMode">
                                        <span>Accept CPU-only mode (skip GPU warning)</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Tab 3: Two-Pass Ensemble Mode -->
                        <div
                            class="tab-panel"
                            id="tab3-panel"
                            role="tabpanel"
                            aria-labelledby="tab3-button"
                        >
                            <div class="ensemble-grid">
                                <!-- Header Row -->
                                <div class="grid-header">
                                    <div class="col-label"></div>
                                    <div class="col-pipeline">Pipeline</div>
                                    <div class="col-separator"></div>
                                    <div class="col-sensitivity">Sensitivity</div>
                                    <div class="col-separator"></div>
                                    <div class="col-scene">Scene Detector</div>
                                    <div class="col-enhancer">Speech Enhancer</div>
                                    <div class="col-segmenter">Speech Segmenter</div>
                                    <div class="col-separator"></div>
                                    <div class="col-model">Model</div>
                                    <div class="col-actions"></div>
                                </div>

                                <!-- Pass 1 Row -->
                                <div class="grid-row" id="pass1-row">
                                    <div class="col-label">Pass 1</div>
                                    <div class="col-pipeline">
                                        <select id="pass1-pipeline" class="form-select compact">
                                            <optgroup label="Whisper-Based">
                                                <option value="balanced" selected>Balanced</option>
                                                <option value="fast">Fast</option>
                                                <option value="faster">Faster</option>
                                                <option value="fidelity">Fidelity</option>
                                            </optgroup>
                                            <optgroup label="HuggingFace">
                                                <option value="transformers">Transformers (HF)</option>
                                            </optgroup>
                                            <optgroup label="Qwen3-ASR">
                                                <option value="qwen">Qwen3-ASR</option>
                                            </optgroup>
                                        </select>
                                    </div>
                                    <div class="col-separator"></div>
                                    <div class="col-sensitivity">
                                        <select id="pass1-sensitivity" class="form-select compact">
                                            <option value="aggressive" selected>Aggressive</option>
                                            <option value="balanced">Balanced</option>
                                            <option value="conservative">Conservative</option>
                                        </select>
                                        <select id="pass1-framer" class="form-select compact" style="display: none;" title="Temporal framing strategy for Qwen3-ASR">
                                            <option value="full-scene" selected>Full Scene</option>
                                            <option value="vad-grouped">VAD Grouped</option>
                                        </select>
                                    </div>
                                    <div class="col-separator"></div>
                                    <div class="col-scene">
                                        <select id="pass1-scene" class="form-select compact">
                                            <option value="auditok">Auditok</option>
                                            <option value="silero">Silero</option>
                                            <option value="semantic" selected>Semantic</option>
                                            <option value="none">None</option>
                                        </select>
                                    </div>
                                    <div class="col-enhancer">
                                        <select id="pass1-enhancer" class="form-select compact">
                                            <option value="none" selected>None</option>
                                            <optgroup label="FFmpeg DSP (Lightweight)">
                                                <option value="ffmpeg-dsp">Audio Filters...</option>
                                            </optgroup>
                                            <optgroup label="ZipEnhancer (Recommended)">
                                                <option value="zipenhancer:torch">Torch (GPU)</option>
                                                <option value="zipenhancer:onnx" disabled class="coming-soon">ONNX (Coming Soon)</option>
                                            </optgroup>
                                            <optgroup label="ClearVoice">
                                                <option value="clearvoice:MossFormer2_SE_48K" disabled title="Unstable on 8GB VRAM - causes memory fragmentation">MossFormer2 48kHz (Unstable)</option>
                                                <option value="clearvoice:FRCRN_SE_16K">FRCRN 16kHz</option>
                                                <option value="clearvoice:MossFormerGAN_SE_16K">MossFormerGAN 16kHz</option>
                                                <option value="clearvoice:MossFormer2_SS_16K">MossFormer2 SS 16kHz</option>
                                            </optgroup>
                                            <optgroup label="BS-RoFormer">
                                                <option value="bs-roformer:vocals" disabled class="coming-soon">Vocals (Coming Soon)</option>
                                            </optgroup>
                                        </select>
                                    </div>
                                    <div class="col-segmenter">
                                        <select id="pass1-segmenter" class="form-select compact">
                                            <option value="silero">Silero v4.0</option>
                                            <option value="silero-v3.1">Silero v3.1</option>
                                            <option value="nemo-lite" disabled title="Requires nemo_toolkit (not installed)">NeMo Lite (N/A)</option>
                                            <option value="whisper-vad">Whisper VAD (small)</option>
                                            <option value="whisper-vad-tiny">Whisper VAD (tiny)</option>
                                            <option value="whisper-vad-medium">Whisper VAD (medium)</option>
                                            <option value="ten" selected>TEN VAD</option>
                                            <option value="none">None</option>
                                        </select>
                                    </div>
                                    <div class="col-separator"></div>
                                    <div class="col-model">
                                        <select id="pass1-model" class="form-select compact">
                                            <option value="large-v2" selected>Large V2</option>
                                            <option value="large-v3">Large V3</option>
                                            <option value="turbo">Turbo</option>
                                        </select>
                                    </div>
                                    <div class="col-actions">
                                        <button type="button" class="btn btn-secondary btn-compact" id="customize-pass1">
                                            Customize Parameters
                                        </button>
                                        <span id="pass1-badge" class="pass-badge default">DEFAULT</span>
                                    </div>
                                </div>

                                <!-- Pass 1 DSP Effects Panel (shown when FFmpeg DSP selected) -->
                                <div class="dsp-effects-panel" id="pass1-dsp-panel" style="display: none;">
                                    <div class="dsp-effects-header">
                                        <span class="dsp-icon">üéõÔ∏è</span>
                                        <span class="dsp-title">Audio Filters</span>
                                        <span class="dsp-hint">Select one or more effects to apply</span>
                                    </div>
                                    <div class="dsp-effects-grid">
                                        <label class="dsp-effect-item" title="Normalize loudness to broadcast standard (-16 LUFS)">
                                            <input type="checkbox" name="pass1-dsp" value="loudnorm" checked>
                                            <span class="dsp-effect-name">Loudness Norm</span>
                                            <span class="dsp-effect-desc">EBU R128 standard</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Normalize audio dynamics while preserving natural sound">
                                            <input type="checkbox" name="pass1-dsp" value="normalize">
                                            <span class="dsp-effect-name">Dynamic Norm</span>
                                            <span class="dsp-effect-desc">Preserve natural sound</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Reduce volume difference between loud and quiet parts">
                                            <input type="checkbox" name="pass1-dsp" value="compress">
                                            <span class="dsp-effect-name">Compress</span>
                                            <span class="dsp-effect-desc">Dynamic range control</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Remove background noise using FFT denoising">
                                            <input type="checkbox" name="pass1-dsp" value="denoise">
                                            <span class="dsp-effect-name">Denoise</span>
                                            <span class="dsp-effect-desc">FFT noise reduction</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Remove low rumble and hum below 80Hz">
                                            <input type="checkbox" name="pass1-dsp" value="highpass">
                                            <span class="dsp-effect-name">High-pass</span>
                                            <span class="dsp-effect-desc">Cut below 80Hz</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Remove high frequency hiss above 8kHz">
                                            <input type="checkbox" name="pass1-dsp" value="lowpass">
                                            <span class="dsp-effect-name">Low-pass</span>
                                            <span class="dsp-effect-desc">Cut above 8kHz</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Reduce harsh sibilant sounds (s, sh, ch)">
                                            <input type="checkbox" name="pass1-dsp" value="deess">
                                            <span class="dsp-effect-name">De-esser</span>
                                            <span class="dsp-effect-desc">Reduce sibilance</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Increase volume by 3 decibels">
                                            <input type="checkbox" name="pass1-dsp" value="amplify">
                                            <span class="dsp-effect-name">Amplify</span>
                                            <span class="dsp-effect-desc">+3dB boost</span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Pass 2 Row -->
                                <div class="grid-row" id="pass2-row">
                                    <div class="col-label">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="pass2-enabled">
                                            <span>Pass 2</span>
                                        </label>
                                    </div>
                                    <div class="col-pipeline">
                                        <select id="pass2-pipeline" class="form-select compact" disabled>
                                            <optgroup label="Whisper-Based">
                                                <option value="balanced">Balanced</option>
                                                <option value="fast">Fast</option>
                                                <option value="faster">Faster</option>
                                                <option value="fidelity">Fidelity</option>
                                            </optgroup>
                                            <optgroup label="HuggingFace">
                                                <option value="transformers">Transformers (HF)</option>
                                            </optgroup>
                                            <optgroup label="Qwen3-ASR">
                                                <option value="qwen" selected>Qwen3-ASR</option>
                                            </optgroup>
                                        </select>
                                    </div>
                                    <div class="col-separator"></div>
                                    <div class="col-sensitivity">
                                        <select id="pass2-sensitivity" class="form-select compact" disabled>
                                            <option value="aggressive">Aggressive</option>
                                            <option value="balanced">Balanced</option>
                                            <option value="conservative" selected>Conservative</option>
                                        </select>
                                        <select id="pass2-framer" class="form-select compact" style="display: none;" title="Temporal framing strategy for Qwen3-ASR" disabled>
                                            <option value="full-scene" selected>Full Scene</option>
                                            <option value="vad-grouped">VAD Grouped</option>
                                        </select>
                                    </div>
                                    <div class="col-separator"></div>
                                    <div class="col-scene">
                                        <select id="pass2-scene" class="form-select compact" disabled>
                                            <option value="auditok">Auditok</option>
                                            <option value="silero">Silero</option>
                                            <option value="semantic" selected>Semantic</option>
                                            <option value="none">None</option>
                                        </select>
                                    </div>
                                    <div class="col-enhancer">
                                        <select id="pass2-enhancer" class="form-select compact" disabled>
                                            <option value="none" selected>None</option>
                                            <optgroup label="FFmpeg DSP (Lightweight)">
                                                <option value="ffmpeg-dsp">Audio Filters...</option>
                                            </optgroup>
                                            <optgroup label="ZipEnhancer (Recommended)">
                                                <option value="zipenhancer:torch">Torch (GPU)</option>
                                                <option value="zipenhancer:onnx" disabled class="coming-soon">ONNX (Coming Soon)</option>
                                            </optgroup>
                                            <optgroup label="ClearVoice">
                                                <option value="clearvoice:MossFormer2_SE_48K" disabled title="Unstable on 8GB VRAM - causes memory fragmentation">MossFormer2 48kHz (Unstable)</option>
                                                <option value="clearvoice:FRCRN_SE_16K">FRCRN 16kHz</option>
                                                <option value="clearvoice:MossFormerGAN_SE_16K">MossFormerGAN 16kHz</option>
                                                <option value="clearvoice:MossFormer2_SS_16K">MossFormer2 SS 16kHz</option>
                                            </optgroup>
                                            <optgroup label="BS-RoFormer">
                                                <option value="bs-roformer:vocals" disabled class="coming-soon">Vocals (Coming Soon)</option>
                                            </optgroup>
                                        </select>
                                    </div>
                                    <div class="col-segmenter">
                                        <select id="pass2-segmenter" class="form-select compact" disabled>
                                            <option value="silero">Silero v4.0</option>
                                            <option value="silero-v3.1">Silero v3.1</option>
                                            <option value="nemo-lite" disabled title="Requires nemo_toolkit (not installed)">NeMo Lite (N/A)</option>
                                            <option value="whisper-vad">Whisper VAD (small)</option>
                                            <option value="whisper-vad-tiny">Whisper VAD (tiny)</option>
                                            <option value="whisper-vad-medium">Whisper VAD (medium)</option>
                                            <option value="ten" selected>TEN VAD</option>
                                            <option value="none">None</option>
                                        </select>
                                    </div>
                                    <div class="col-separator"></div>
                                    <div class="col-model">
                                        <select id="pass2-model" class="form-select compact" disabled>
                                            <option value="Qwen/Qwen3-ASR-1.7B" selected>Qwen3-ASR-1.7B    8GB</option>
                                            <option value="Qwen/Qwen3-ASR-0.6B">Qwen3-ASR-0.6B    4GB</option>
                                        </select>
                                    </div>
                                    <div class="col-actions">
                                        <button type="button" class="btn btn-secondary btn-compact" id="customize-pass2" disabled>
                                            Customize Parameters
                                        </button>
                                        <span id="pass2-badge" class="pass-badge default">DEFAULT</span>
                                    </div>
                                </div>

                                <!-- Pass 2 DSP Effects Panel (shown when FFmpeg DSP selected) -->
                                <div class="dsp-effects-panel" id="pass2-dsp-panel" style="display: none;">
                                    <div class="dsp-effects-header">
                                        <span class="dsp-icon">üéõÔ∏è</span>
                                        <span class="dsp-title">Audio Filters</span>
                                        <span class="dsp-hint">Select one or more effects to apply</span>
                                    </div>
                                    <div class="dsp-effects-grid">
                                        <label class="dsp-effect-item" title="Normalize loudness to broadcast standard (-16 LUFS)">
                                            <input type="checkbox" name="pass2-dsp" value="loudnorm" checked>
                                            <span class="dsp-effect-name">Loudness Norm</span>
                                            <span class="dsp-effect-desc">EBU R128 standard</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Normalize audio dynamics while preserving natural sound">
                                            <input type="checkbox" name="pass2-dsp" value="normalize">
                                            <span class="dsp-effect-name">Dynamic Norm</span>
                                            <span class="dsp-effect-desc">Preserve natural sound</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Reduce volume difference between loud and quiet parts">
                                            <input type="checkbox" name="pass2-dsp" value="compress">
                                            <span class="dsp-effect-name">Compress</span>
                                            <span class="dsp-effect-desc">Dynamic range control</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Remove background noise using FFT denoising">
                                            <input type="checkbox" name="pass2-dsp" value="denoise">
                                            <span class="dsp-effect-name">Denoise</span>
                                            <span class="dsp-effect-desc">FFT noise reduction</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Remove low rumble and hum below 80Hz">
                                            <input type="checkbox" name="pass2-dsp" value="highpass">
                                            <span class="dsp-effect-name">High-pass</span>
                                            <span class="dsp-effect-desc">Cut below 80Hz</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Remove high frequency hiss above 8kHz">
                                            <input type="checkbox" name="pass2-dsp" value="lowpass">
                                            <span class="dsp-effect-name">Low-pass</span>
                                            <span class="dsp-effect-desc">Cut above 8kHz</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Reduce harsh sibilant sounds (s, sh, ch)">
                                            <input type="checkbox" name="pass2-dsp" value="deess">
                                            <span class="dsp-effect-name">De-esser</span>
                                            <span class="dsp-effect-desc">Reduce sibilance</span>
                                        </label>
                                        <label class="dsp-effect-item" title="Increase volume by 3 decibels">
                                            <input type="checkbox" name="pass2-dsp" value="amplify">
                                            <span class="dsp-effect-name">Amplify</span>
                                            <span class="dsp-effect-desc">+3dB boost</span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Merge Strategy Row -->
                                <div class="grid-row" id="merge-row">
                                    <div class="col-label">Merge</div>
                                    <div class="col-merge">
                                        <select id="merge-strategy" class="form-select merge-select" disabled>
                                            <option value="pass1_primary" selected>Pass 1 + Fill From Pass 2</option>
                                            <option value="smart_merge">Smart Merge (Best Quality)</option>
                                            <option value="full_merge">Full Merge (All Lines)</option>
                                            <option value="pass2_primary">Pass 2 + Fill From Pass 1</option>
                                            <option value="pass1_overlap">Pass 1 + Fill (30% Overlap)</option>
                                            <option value="pass2_overlap">Pass 2 + Fill (30% Overlap)</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- AI-Translate Integration Row -->
                                <div class="ensemble-translate-row" id="ensembleTranslateRow">
                                    <div class="translate-checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="ensembleTranslateAfter">
                                            <span>AI-translate</span>
                                        </label>
                                    </div>
                                    <div class="translate-inline-settings" id="ensembleTranslateSettings">
                                        <select id="ensembleTranslateProvider" class="form-select compact" title="Translation provider">
                                            <option value="local">Local LLM</option>
                                            <option value="deepseek">DeepSeek</option>
                                            <option value="gemini">Gemini</option>
                                            <option value="claude">Claude</option>
                                            <option value="gpt">GPT</option>
                                            <option value="openrouter">OpenRouter</option>
                                            <option value="glm">GLM (Zhipu AI)</option>
                                            <option value="groq">Groq</option>
                                        </select>
                                        <select id="ensembleTranslateModel" class="form-select compact" title="Model">
                                            <option value="">Default</option>
                                        </select>
                                        <input type="text" id="ensembleTranslateModelOverride" class="form-input model-override-input"
                                               placeholder="Model override (optional)"
                                               title="Custom model path or name. Leave empty to use selected model.">
                                        <button type="button" class="btn btn-secondary btn-compact" id="ensembleTranslateSettingsBtn" title="Translation Settings">
                                            Translation Settings
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Tab 4: SRT Translate -->
                        <div
                            class="tab-panel"
                            id="tab4-panel"
                            role="tabpanel"
                            aria-labelledby="tab4-button"
                        >
                            <div class="translator-container">
                                <!-- NOTE: File input uses the shared SOURCE section above.
                                     When this tab is active, Add File(s) filters for .srt files
                                     and Add Folder scans for .srt files in the selected folder. -->

                                <!-- Row 1: Provider + Model + Override/Custom Model -->
                                <div class="translator-section translator-compact-section">
                                    <div class="translator-provider-grid">
                                        <div class="form-group">
                                            <label for="translatorProvider" class="form-label">Provider:</label>
                                            <select id="translatorProvider" class="form-select">
                                                <option value="local">Local LLM</option>
                                                <option value="deepseek">DeepSeek</option>
                                                <option value="gemini">Gemini</option>
                                                <option value="claude">Claude</option>
                                                <option value="gpt">GPT</option>
                                                <option value="openrouter">OpenRouter</option>
                                                <option value="glm">GLM (Zhipu AI)</option>
                                                <option value="groq">Groq</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="translatorModel" class="form-label">Model:</label>
                                            <select id="translatorModel" class="form-select">
                                                <option value="">Default</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="translatorCustomModel" class="form-label">Override/Custom Model:</label>
                                            <input type="text" id="translatorCustomModel" class="form-input" placeholder="Optional model override">
                                        </div>
                                    </div>
                                </div>

                                <!-- Row 2: API Key + Test Connection -->
                                <div class="translator-section translator-compact-section">
                                    <div class="translator-apikey-row">
                                        <div class="form-group translator-api-key-group">
                                            <label for="translatorApiKey" class="form-label">API Key:</label>
                                            <div class="input-with-status">
                                                <input type="password" id="translatorApiKey" class="form-input" placeholder="Enter API key or use environment variable">
                                                <span id="translatorApiStatus" class="api-status"></span>
                                            </div>
                                        </div>
                                        <div class="form-group translator-test-btn-group">
                                            <button type="button" class="btn btn-secondary" id="translatorTestConnection">Test Connection</button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Row 3: Source Language + Target Language + Tone -->
                                <div class="translator-section translator-compact-section">
                                    <div class="translator-settings-grid">
                                        <div class="form-group">
                                            <label for="translatorSourceLang" class="form-label">Source Language:</label>
                                            <select id="translatorSourceLang" class="form-select">
                                                <option value="japanese" selected>Japanese</option>
                                                <option value="korean">Korean</option>
                                                <option value="chinese">Chinese</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="translatorTargetLang" class="form-label">Target Language:</label>
                                            <select id="translatorTargetLang" class="form-select">
                                                <option value="english" selected>English</option>
                                                <option value="chinese">Chinese</option>
                                                <option value="indonesian">Indonesian</option>
                                                <option value="spanish">Spanish</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="translatorTone" class="form-label">Tone/Style:</label>
                                            <select id="translatorTone" class="form-select">
                                                <option value="standard" selected>Standard</option>
                                                <option value="pornify">Adult/Explicit</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Advanced Settings (collapsible, includes movie context) -->
                                <details class="translator-section translator-advanced-section">
                                    <summary class="collapsible-header">
                                        <span class="collapse-icon">‚ñ∂</span>
                                        Advanced Settings
                                    </summary>
                                    <div class="translator-advanced-grid">
                                        <div class="form-group">
                                            <label for="translatorMovieTitle" class="form-label">Movie Title:</label>
                                            <input type="text" id="translatorMovieTitle" class="form-input" placeholder="e.g., ABC-123">
                                        </div>
                                        <div class="form-group">
                                            <label for="translatorNames" class="form-label">Names (one per line):</label>
                                            <textarea id="translatorNames" class="form-textarea" rows="2" placeholder="Character/actress names"></textarea>
                                        </div>
                                        <div class="form-group" style="grid-column: span 2;">
                                            <label for="translatorPlot" class="form-label">Plot Summary:</label>
                                            <textarea id="translatorPlot" class="form-textarea" rows="2" placeholder="Brief plot description for context..."></textarea>
                                        </div>
                                        <div class="form-group">
                                            <label for="translatorSceneThreshold" class="form-label">Scene Threshold (sec):</label>
                                            <input type="number" id="translatorSceneThreshold" class="form-input" value="60" min="1" max="300">
                                        </div>
                                        <div class="form-group">
                                            <label for="translatorMaxBatchSize" class="form-label">Max Batch Size:</label>
                                            <input type="number" id="translatorMaxBatchSize" class="form-input" value="30" min="1" max="100">
                                        </div>
                                        <div class="form-group">
                                            <label for="translatorMaxRetries" class="form-label">Max Retries:</label>
                                            <input type="number" id="translatorMaxRetries" class="form-input" value="3" min="1" max="10">
                                        </div>
                                        <div class="form-group">
                                            <label for="translatorRateLimit" class="form-label">Rate Limit (req/min):</label>
                                            <input type="number" id="translatorRateLimit" class="form-input" placeholder="No limit" min="1" max="1000">
                                        </div>
                                        <div class="form-group" style="grid-column: span 2;">
                                            <label for="translatorCustomEndpoint" class="form-label">Custom Endpoint URL:</label>
                                            <input type="text" id="translatorCustomEndpoint" class="form-input" placeholder="https://api.example.com/v1 (for OpenAI-compatible APIs)">
                                        </div>
                                    </div>
                                </details>

                                <!-- Progress + Controls -->
                                <div class="translator-section translator-progress-section">
                                    <div class="translator-progress-container">
                                        <div class="translator-progress-bar">
                                            <div class="translator-progress-fill" id="translatorProgressFill"></div>
                                        </div>
                                        <span class="translator-status-label" id="translatorStatusLabel">Idle</span>
                                    </div>
                                </div>
                                <div class="translator-controls-section">
                                    <div class="translator-button-group">
                                        <button type="button" class="btn btn-primary btn-lg" id="translatorStartBtn" disabled>Start</button>
                                        <button type="button" class="btn btn-secondary btn-lg" id="translatorCancelBtn" disabled>Cancel</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </section>

            <!-- Run Controls Section -->
            <section class="section run-section">
                <div class="section-content">
                    <!-- Progress Bar -->
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <span class="status-label" id="statusLabel">Idle</span>
                    </div>

                    <!-- Control Buttons -->
                    <div class="button-group">
                        <button type="button" class="btn btn-primary btn-lg" id="startBtn">
                            Start
                        </button>
                        <button type="button" class="btn btn-secondary btn-lg" id="cancelBtn" disabled>
                            Cancel
                        </button>
                    </div>
                </div>
            </section>

            <!-- Console Section -->
            <section class="section console-section">
                <div class="section-header">
                    <h2>Console</h2>
                    <button type="button" class="btn btn-text btn-sm" id="clearConsoleBtn">
                        Clear
                    </button>
                </div>
                <div class="section-content">
                    <div class="console-output" id="consoleOutput">
                        <div class="console-line">Ready.</div>
                    </div>
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <p>WhisperJAV - Subtitle generation for Japanese Adult Videos |
               <a href="#" onclick="showAbout(); return false;" style="color: var(--primary-color); text-decoration: none;">About</a>
            </p>
        </footer>

    </div>

    <!-- About Dialog Modal -->
    <div class="modal-overlay" id="aboutModal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h2>About WhisperJAV</h2>
                <button class="modal-close" onclick="closeAbout()" aria-label="Close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="about-logo">üé¨</div>
                <div class="about-title">WhisperJAV GUI</div>
                <div class="about-version" id="aboutVersion">Version 1.7.4</div>

                <div class="about-section">
                    <h3>Description</h3>
                    <p>Japanese Adult Video Subtitle Generator powered by OpenAI Whisper with specialized enhancements for Japanese language processing, scene detection, and voice activity detection.</p>
                </div>

                <div class="about-section">
                    <h3>Key Features</h3>
                    <ul>
                        <li>Multi-mode processing (Balanced, Fast, Faster)</li>
                        <li>Scene detection and voice activity detection</li>
                        <li>Japanese language optimization</li>
                        <li>Batch processing support</li>
                        <li>Real-time progress monitoring</li>
                    </ul>
                </div>

                <div class="about-section">
                    <h3>Technology</h3>
                    <p>Built with PyWebView and Python. This modern web-based interface provides a clean and intuitive experience for generating high-quality Japanese subtitles.</p>
                </div>

                <div class="about-section">
                    <h3>Keyboard Shortcuts</h3>
                    <ul>
                        <li>Ctrl+O - Add files</li>
                        <li>Ctrl+R - Start processing</li>
                        <li>Escape - Cancel process</li>
                        <li>F1 - Show this dialog</li>
                    </ul>
                </div>

                <div class="about-section">
                    <p style="text-align: center; margin-top: 20px;">
                        <a href="https://github.com/meizhong986/WhisperJAV" class="about-link" target="_blank">Visit GitHub Repository</a>
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeAbout()">Close</button>
            </div>
        </div>
    </div>

    <!-- Changelog Modal -->
    <div class="modal-overlay" id="changelogModal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h2 id="changelogTitle">What's New</h2>
                <button class="modal-close" onclick="ChangelogManager.close()" aria-label="Close">&times;</button>
            </div>
            <div class="modal-body" id="changelogBody">
                <div class="changelog-loading" id="changelogLoading">
                    <div class="changelog-spinner">&#x21BB;</div>
                    <p>Loading release notes...</p>
                </div>
                <div class="changelog-content" id="changelogContent" style="display: none;">
                    <div class="changelog-version-header">
                        <span class="changelog-version" id="changelogVersion">v1.7.5</span>
                        <span class="changelog-date" id="changelogDate"></span>
                    </div>
                    <div class="changelog-notes" id="changelogNotes">
                        <!-- Release notes will be inserted here -->
                    </div>
                </div>
                <div class="changelog-error" id="changelogError" style="display: none;">
                    <p>Could not load release notes.</p>
                    <a href="https://github.com/meizhong986/WhisperJAV/releases" target="_blank" class="about-link">
                        View releases on GitHub
                    </a>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="ChangelogManager.openGitHub()">View on GitHub</button>
                <button class="btn btn-primary" onclick="ChangelogManager.close()">Close</button>
            </div>
        </div>
    </div>

    <!-- Update Check Modal -->
    <div class="modal-overlay" id="updateCheckModal">
        <div class="modal-dialog modal-update-check">
            <div class="modal-header">
                <h2>Check for Updates</h2>
                <button class="modal-close" id="updateCheckModalClose" aria-label="Close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Loading State -->
                <div id="updateCheckLoading" class="update-check-loading">
                    <div class="spinner"></div>
                    <p>Checking for updates...</p>
                </div>

                <!-- Result State -->
                <div id="updateCheckResult" class="update-check-result" style="display: none;">
                    <!-- Current Version Info -->
                    <div class="current-version-info">
                        <span class="version-label">Installed:</span>
                        <span class="version-value" id="updateCurrentVersion">v1.7.5</span>
                        <span class="commit-hash" id="updateCurrentCommit"></span>
                    </div>

                    <!-- Stable Release Track -->
                    <div class="update-track update-track-stable" id="stableTrack">
                        <div class="track-header">
                            <span class="track-icon">&#x1F4E6;</span>
                            <span class="track-title">Stable Release</span>
                        </div>
                        <div class="track-content">
                            <div id="stableUpToDate" class="track-status track-status-ok" style="display: none;">
                                <span class="status-icon">&#x2713;</span>
                                <span>v<span id="stableLatestVersion">1.7.5</span> - You're up to date</span>
                            </div>
                            <div id="stableUpdateAvailable" class="track-status track-status-update" style="display: none;">
                                <span class="status-icon">&#x2191;</span>
                                <span>v<span id="stableNewVersion">1.7.6</span> available</span>
                                <span class="update-badge" id="stableUpdateBadge">PATCH</span>
                            </div>
                            <div id="stableReleaseNotes" class="release-notes-section" style="display: none;">
                                <details class="release-notes-details">
                                    <summary>Release Notes</summary>
                                    <div id="stableReleaseNotesContent" class="release-notes-content"></div>
                                </details>
                            </div>
                            <div id="stableActions" class="track-actions" style="display: none;">
                                <button id="updateToStable" class="btn btn-primary btn-sm">Update to Stable</button>
                            </div>
                        </div>
                    </div>

                    <!-- Development Track -->
                    <div class="update-track update-track-dev" id="devTrack">
                        <div class="track-header">
                            <span class="track-icon">&#x26A1;</span>
                            <span class="track-title">Development</span>
                            <span class="track-subtitle">(main branch)</span>
                        </div>
                        <div class="track-content">
                            <div id="devUpToDate" class="track-status track-status-ok" style="display: none;">
                                <span class="status-icon">&#x2713;</span>
                                <span>Up to date with main branch</span>
                            </div>
                            <div id="devUpdateAvailable" class="track-status track-status-update" style="display: none;">
                                <span class="status-icon">&#x2191;</span>
                                <span><span id="devCommitsAhead">0</span> commit(s) ahead</span>
                            </div>
                            <div id="devCommitsList" class="dev-commits-list" style="display: none;">
                                <div class="commits-header">Recent commits:</div>
                                <ul id="devRecentCommits" class="commits-list"></ul>
                            </div>
                            <div id="devActions" class="track-actions" style="display: none;">
                                <button id="updateToDev" class="btn btn-secondary btn-sm">Update to Latest Dev</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Error State -->
                <div id="updateCheckError" class="update-check-error" style="display: none;">
                    <p>Failed to check for updates. Please check your internet connection and try again.</p>
                </div>
            </div>
            <div class="modal-footer" id="updateCheckFooter">
                <button id="updateCheckLater" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <!-- Customize Component Modal -->
    <div class="modal-overlay" id="customizeModal">
        <div class="modal-dialog modal-lg">
            <div class="modal-header">
                <h2 id="customizeModalTitle">Component Settings</h2>
                <button class="modal-close" id="customizeModalClose" aria-label="Close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Tab Navigation -->
                <div class="modal-tabs">
                    <button class="modal-tab active" data-tab="model">Model</button>
                    <button class="modal-tab" data-tab="quality">Quality</button>
                    <button class="modal-tab" data-tab="segmenter">Segmenter</button>
                    <button class="modal-tab" data-tab="enhancer">Enhancer</button>
                    <button class="modal-tab" data-tab="scene">Scene</button>
                    <button class="modal-tab" data-tab="context" style="display: none;">Context</button>
                </div>
                <!-- Tab Panels -->
                <div class="modal-tab-content">
                    <div id="tab-model" class="modal-tab-panel active">
                        <!-- Model selection: model name and device -->
                    </div>
                    <div id="tab-quality" class="modal-tab-panel">
                        <!-- Quality params: transcriber thresholds, decoder settings -->
                    </div>
                    <div id="tab-segmenter" class="modal-tab-panel">
                        <!-- Speech segmenter: backend-specific parameters -->
                    </div>
                    <div id="tab-enhancer" class="modal-tab-panel">
                        <!-- Speech enhancer: backend-specific parameters -->
                    </div>
                    <div id="tab-scene" class="modal-tab-panel">
                        <!-- Scene detection: method and parameters -->
                    </div>
                    <div id="tab-context" class="modal-tab-panel">
                        <!-- Context hints and generation safety (Qwen only) -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="customizeModalReset">Reset to Defaults</button>
                <button class="btn btn-primary" id="customizeModalApply">Apply</button>
                <button class="btn btn-primary" id="customizeModalOK">OK</button>
            </div>
        </div>
    </div>

    <!-- Translation Settings Modal -->
    <div class="modal-overlay" id="translationSettingsModal">
        <div class="modal-dialog modal-translation-settings">
            <div class="modal-header">
                <h2>Translation Settings</h2>
                <button class="modal-close" id="translationSettingsClose" aria-label="Close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- API Key Section -->
                <div class="translation-settings-section">
                    <div class="form-row">
                        <div class="form-group flex-grow">
                            <label for="translationApiKey" class="form-label">API Key:</label>
                            <div class="input-with-status">
                                <input type="password" id="translationApiKey" class="form-input" placeholder="Enter API key or use environment variable">
                                <span id="translationApiStatus" class="api-status"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <button type="button" class="btn btn-secondary" id="translationTestConnection">
                                Test Connection
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Language Settings -->
                <div class="translation-settings-section">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="translationTargetLang" class="form-label">Target Language:</label>
                            <select id="translationTargetLang" class="form-select">
                                <option value="english" selected>English</option>
                                <option value="chinese">Chinese</option>
                                <option value="indonesian">Indonesian</option>
                                <option value="spanish">Spanish</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="translationTone" class="form-label">Tone/Style:</label>
                            <select id="translationTone" class="form-select">
                                <option value="standard" selected>Standard</option>
                                <option value="pornify">Adult/Explicit</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Movie Context Section -->
                <div class="translation-settings-section translation-context-section">
                    <div class="section-header-inline">
                        <span class="section-title">Movie Context</span>
                        <span class="section-note">(single file only)</span>
                    </div>
                    <div class="context-note" id="multiFileWarning" style="display: none;">
                        <span class="note-icon">‚Ñπ</span>
                        <span>Context fields apply to single-file processing. Ignored for batch processing.</span>
                    </div>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="translationMovieTitle" class="form-label">Movie Title:</label>
                            <input type="text" id="translationMovieTitle" class="form-input" placeholder="e.g., ABC-123">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="translationActress" class="form-label">Actress Name(s):</label>
                            <input type="text" id="translationActress" class="form-input" placeholder="e.g., Name1, Name2">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="translationPlot" class="form-label">Plot Summary:</label>
                            <textarea id="translationPlot" class="form-textarea" rows="2" placeholder="Brief plot description for context..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Advanced Settings (Collapsible) -->
                <details class="translation-settings-section translation-advanced-section">
                    <summary class="section-header-collapsible">
                        <span class="section-title">Advanced Settings</span>
                        <span class="collapse-icon">‚ñ∂</span>
                    </summary>
                    <div class="advanced-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="translationSceneThreshold" class="form-label">Scene Threshold (sec):</label>
                                <input type="number" id="translationSceneThreshold" class="form-input" value="60" min="1" max="300">
                            </div>
                            <div class="form-group">
                                <label for="translationMaxBatchSize" class="form-label">Max Batch Size:</label>
                                <input type="number" id="translationMaxBatchSize" class="form-input" value="30" min="1" max="100">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="translationTemperature" class="form-label">Temperature:</label>
                                <input type="number" id="translationTemperature" class="form-input" value="0.5" min="0" max="2" step="0.1">
                            </div>
                            <div class="form-group">
                                <label for="translationTopP" class="form-label">Top P:</label>
                                <input type="number" id="translationTopP" class="form-input" value="0.9" min="0" max="1" step="0.1">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group full-width">
                                <label for="translationCustomEndpoint" class="form-label">Custom Endpoint URL:</label>
                                <input type="text" id="translationCustomEndpoint" class="form-input" placeholder="https://api.example.com/v1 (for OpenAI-compatible APIs)">
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="translationSettingsCancel">Cancel</button>
                <button class="btn btn-primary" id="translationSettingsSave">Save</button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="app.js"></script>
</body>
</html>
