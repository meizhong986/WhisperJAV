# Conda-Constructor Configuration for WhisperJAV v1.5.3
# =========================================================
#
# This creates a Windows installer that:
# - Installs minimal conda environment to %LOCALAPPDATA%\WhisperJAV
# - Downloads PyTorch and dependencies during post-install
# - Defers AI model downloads to first application run
# - Checks for WebView2 and provides download link if missing
#
# Build command: constructor . --config construct_v1.5.3.yaml
# Output: WhisperJAV-1.5.3-Windows-x86_64.exe

name: WhisperJAV
version: 1.5.3

# Conda channels for package resolution
channels:
  - conda-forge
  - defaults

# Minimal base environment (heavy dependencies in post-install)
specs:
  - python=3.10.18  # Pinned for stability (tested version)
  - pip             # Package installer
  - git             # Required for GitHub installs
  - ffmpeg          # Audio/video processing (conda version preferred)

# Install in dependency order for reliability
install_in_dependency_order: true

# Default installation path (user can override during install)
default_prefix: '%LOCALAPPDATA%\WhisperJAV'

# Post-installation script (runs after conda env setup)
post_install: post_install_v1.5.3.bat

# Files to include in installer package
extra_files:
  - post_install_v1.5.3.bat
  - post_install_v1.5.3.py
  - requirements_v1.5.3.txt
  - WhisperJAV_Launcher_v1.5.3.py
  - create_desktop_shortcut_v1.5.3.bat
  - README_INSTALLER_v1.5.3.txt
  - LICENSE.txt
  - whisperjav_icon.ico
  - whisperjav_local.whl

# Installer metadata
license_file: LICENSE.txt
welcome_image: whisperjav_icon.ico  # Optional: 164x314 PNG or ICO
# icon_image: whisperjav_icon.ico  # Installer icon (if desired)

# Installation options
# keep_pkgs: false  # Delete package cache after install (saves space)
# attempt_hardlinks: true  # Use hardlinks to save disk space
